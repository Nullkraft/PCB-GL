Bottom: d3c785bbc8d825f7da8c329fef5a345e1f52d3a2
Top:    e3bd36a31d1dbf261204b60b1f8806ea534aff1b
Author: Peter Clifton <pcjc2@cam.ac.uk>
Date:   2016-01-06 16:58:57 +0000

Try a new, different sized VBO buffer for each upload.


---

diff --git a/src/hid/common/hidgl.c b/src/hid/common/hidgl.c
index 32b6dc5..66586f1 100644
--- a/src/hid/common/hidgl.c
+++ b/src/hid/common/hidgl.c
@@ -153,10 +153,6 @@ hidgl_init_triangle_array (hidgl_instance *hidgl)
    */
   priv->buffer.use_map = false;
 
-  /* If using VBOs (but not mapping), we only need to this once */
-  if (priv->buffer.use_vbo && !priv->buffer.use_map)
-    glBufferData (GL_ARRAY_BUFFER, BUFFER_SIZE, NULL, GL_STREAM_DRAW);
-
   priv->buffer.triangle_array = NULL;
   hidgl_reset_triangle_array (hidgl);
 }
@@ -198,10 +194,10 @@ hidgl_flush_triangles (hidgl_instance *hidgl)
       glUnmapBuffer (GL_ARRAY_BUFFER);
       priv->buffer.triangle_array = NULL;
     } else {
-      /* NB: We only upload the portion of the buffer we've used */
-      glBufferSubData (GL_ARRAY_BUFFER, 0,
-                       BUFFER_STRIDE * priv->buffer.vertex_count,
-                       priv->buffer.triangle_array);
+      glBufferData (GL_ARRAY_BUFFER,
+                    BUFFER_STRIDE * priv->buffer.vertex_count,
+                    priv->buffer.triangle_array,
+                    GL_STREAM_DRAW);
     }
   } else {
     data_pointer = priv->buffer.triangle_array;
